---
title: "Test R Markdown Document"
author: "Your Name"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
```

## Introduction

This is a test R Markdown document with fake data and visualizations.

## Create Fake Dataset

```{r create-data}
# Set seed for reproducibility
set.seed(123)

# Create fake dataset
df <- data.frame(
  id = 1:100,
  name = paste("Person", 1:100),
  age = sample(18:65, 100, replace = TRUE),
  salary = round(rnorm(100, mean = 50000, sd = 15000), 0),
  department = sample(c("Sales", "Marketing", "Engineering", "HR", "Finance"), 100, replace = TRUE),
  years_experience = sample(0:20, 100, replace = TRUE),
  performance_score = round(runif(100, min = 1, max = 10), 1)
)

# Display first few rows
head(df)
```

## Data Summary

```{r data-summary}

# Basic summary statistics
summary(df)

# Count by department
table(df$department)
```

## Visualizations

### Age Distribution

```{r age-histogram}
ggplot(df, aes(x = age)) +
  geom_histogram(bins = 15, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Age Distribution of Employees",
       x = "Age",
       y = "Count") +
  theme_minimal()
  
```

### Salary by Department

```{r salary-boxplot}
ggplot(df, aes(x = department, y = salary, fill = department)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Salary Distribution by Department",
       x = "Department",
       y = "Salary ($)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none") +
  scale_y_continuous(labels = scales::comma)
```

### Experience vs Performance

```{r scatter-plot}
ggplot(df, aes(x = years_experience, y = performance_score, color = department)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed") +
  labs(title = "Years of Experience vs Performance Score",
       x = "Years of Experience",
       y = "Performance Score",
       color = "Department") +
  theme_minimal() +
  scale_color_brewer(type = "qual", palette = "Set2") 
```

### Age vs Salary by Department

```{r faceted-plot}
ggplot(df, aes(x = age, y = salary)) +
  geom_point(aes(color = department), alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, color = "black") +
  facet_wrap(~department, scales = "free") +
  labs(title = "Age vs Salary by Department",
       x = "Age",
       y = "Salary ($)") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_y_continuous(labels = scales::comma)
```

## Summary Statistics Table

```{r summary-table}
# Create summary table by department
summary_stats <- df %>%
  group_by(department) %>%
  summarise(
    count = n(),
    avg_age = round(mean(age), 1),
    avg_salary = round(mean(salary), 0),
    avg_experience = round(mean(years_experience), 1),
    avg_performance = round(mean(performance_score), 1)
  )

knitr::kable(summary_stats, 
             caption = "Summary Statistics by Department",
             col.names = c("Department", "Count", "Avg Age", "Avg Salary", "Avg Experience", "Avg Performance"))
```

## Conclusion

This document demonstrates:
- Creating fake data in R
- Basic data exploration
- Multiple types of ggplot2 visualizations
- Summary statistics and tables

The data shows interesting patterns across departments in terms of age, salary, experience, and performance metrics.